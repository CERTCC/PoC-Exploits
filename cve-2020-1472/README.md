# CVE-2020-1472
# Microsoft Netlogon Remote Protocol vulnerable to elevation of privilege

You can use this suricata rules and sample PCAPS to verify
if your network is seeing attacks for MS RPC vulnerability
CVE-2020-1472.

# For wireshark filters use example below
(netlogon.clientcred == 00:00:00:00:00:00:00:00 && netlogon.neg_flags == 0x212fffff)

# Exploits

Visit [https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472) for samples of password hack and reversal.

# PCAPS

The sample packets with 200 attack attempts and 2000 attack attempts are enclosed. The rules have in-built threshold please change it as needed. Current rule should fire most 1 alert within a period of 3 minutes.

# Suricata Info

Tested with Suricata 3.2 RELEASE with no default rules in /etc/suricata/rules to avoid noise. Command used to test was

`suricata -k none -c /etc/suricata/suricata.yaml  -s cve-2020-1472.rules -l log/ -r cve-2020-1472-exploit.pcap`

# CERT Advisory

Read more at [https://kb.cert.org/vuls/id/490028](https://kb.cert.org/vuls/id/490028)

# Caveats

Rules have been fine-tuned to detect current exploits. They may not be able to detect all variants of such attacks.  Treat these as experimental and subject normal IDS false/positives and false/negatives, depending on the diverse environments and the changing/evolving malware/attacks.

