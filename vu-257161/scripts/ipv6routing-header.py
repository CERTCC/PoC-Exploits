#!/usr/bin/python3

from scapy.all import *
import socket
import sys
import signal

class IPv6OptionHeaderRouting ( IPv6OptionHeader ):
    name = " IPv6 Option Header Routing "
    fieldsdesc = [ ByteEnumField ( "nh" , 59 , ipv6nh ) ,
                   ByteField ("len" , None),
                   ByteField ( "type" , 0),
                   ByteField ( "segleft" ,None),
                   BitField ( "reserved", 0, 32),
                   IP6RoutingHeaderListField( "addresses" , [])]
overloadfields = { IPv6 : { "nh" : 43 }}
#> a = sr1(IPv6(dst="2001:4f8:4:7:2e0:81ff:fe52:9a6b")/ \
#          IPv6OptionHeaderRouting(addresses=["2001:78:1:32::1", "2001:20:82:203:fea5:385"])/ \
#          ICMPv6EchoRequest(data=RandString(7)), verbose=0)
#>>> a.src
#"2001:20:82:203:fea5:385"
